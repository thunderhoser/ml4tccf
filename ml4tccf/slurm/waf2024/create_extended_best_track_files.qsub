#!/bin/bash

#SBATCH --job-name="create_extended_best_track_files"
#SBATCH --partition="fge"
#SBATCH --account="rda-ghpcs"
#SBATCH --qos="gpu"
#SBATCH --ntasks=1
#SBATCH --nodes=1
#SBATCH --cpus-per-task=1
##SBATCH --nodes=1
##SBATCH --ntasks=1
##SBATCH --cpus-per-task=1
##SBATCH --ntasks-per-node=1
#SBATCH --time=04:00:00
#SBATCH --array=0-15
#SBATCH --exclude=h28n12
##SBATCH --exclude=h31n03,h28n12
##SBATCH --exclude=h29n01,h26n05,h28n06,h29n07,h30n03,h30n15
#SBATCH --mail-type=BEGIN,END,FAIL
#SBATCH --mail-user=ryan.lagerquist@noaa.gov
#SBATCH --output=create_extended_best_track_files_%A_%a.out

conda init
conda activate base

echo `which conda`
echo `which python`
echo `which python3`

# PATH=/usr/local/cuda/bin:$PATH
echo $PATH

CODE_DIR_NAME="/scratch1/RDARCH/rda-ghpcs/Ryan.Lagerquist/ml4tccf_standalone/ml4tccf"

SATELLITE_FILE_PATTERNS=("/scratch1/RDARCH/rda-ghpcs/Ryan.Lagerquist/ml4tccf_project/satellite_data/processed/satellite_2016WP*zarr" "/scratch1/RDARCH/rda-ghpcs/Ryan.Lagerquist/ml4tccf_project/satellite_data/processed/satellite_2017WP*zarr" "/scratch1/RDARCH/rda-ghpcs/Ryan.Lagerquist/ml4tccf_project/satellite_data/processed/satellite_2018WP*zarr" "/scratch1/RDARCH/rda-ghpcs/Ryan.Lagerquist/ml4tccf_project/satellite_data/processed/satellite_2019WP*zarr" "/scratch1/RDARCH/rda-ghpcs/Ryan.Lagerquist/ml4tccf_project/satellite_data/processed/satellite_2020WP*zarr" "/scratch1/RDARCH/rda-ghpcs/Ryan.Lagerquist/ml4tccf_project/satellite_data/processed/satellite_2021WP*zarr" "/scratch1/RDARCH/rda-ghpcs/Ryan.Lagerquist/ml4tccf_project/satellite_data/processed/satellite_2017AL*zarr" "/scratch1/RDARCH/rda-ghpcs/Ryan.Lagerquist/ml4tccf_project/satellite_data/processed/satellite_2018AL*zarr" "/scratch1/RDARCH/rda-ghpcs/Ryan.Lagerquist/ml4tccf_project/satellite_data/processed/satellite_2019AL*zarr" "/scratch1/RDARCH/rda-ghpcs/Ryan.Lagerquist/ml4tccf_project/satellite_data/processed/satellite_2020AL*zarr" "/scratch1/RDARCH/rda-ghpcs/Ryan.Lagerquist/ml4tccf_project/satellite_data/processed/satellite_2021AL*zarr" "/scratch1/RDARCH/rda-ghpcs/Ryan.Lagerquist/ml4tccf_project/satellite_data/processed/satellite_2018EP*zarr" "/scratch1/RDARCH/rda-ghpcs/Ryan.Lagerquist/ml4tccf_project/satellite_data/processed/satellite_2019EP*zarr" "/scratch1/RDARCH/rda-ghpcs/Ryan.Lagerquist/ml4tccf_project/satellite_data/processed/satellite_2020EP*zarr" "/scratch1/RDARCH/rda-ghpcs/Ryan.Lagerquist/ml4tccf_project/satellite_data/processed/satellite_2021EP*zarr" "/scratch1/RDARCH/rda-ghpcs/Ryan.Lagerquist/ml4tccf_project/satellite_data/processed/satellite_2022EP*zarr")
FAKE_EBTRK_FILE_NAMES=("/scratch1/RDARCH/rda-ghpcs/Ryan.Lagerquist/ml4tccf_project/fake_extended_best_track_2016WP.nc" "/scratch1/RDARCH/rda-ghpcs/Ryan.Lagerquist/ml4tccf_project/fake_extended_best_track_2017WP.nc" "/scratch1/RDARCH/rda-ghpcs/Ryan.Lagerquist/ml4tccf_project/fake_extended_best_track_2018WP.nc" "/scratch1/RDARCH/rda-ghpcs/Ryan.Lagerquist/ml4tccf_project/fake_extended_best_track_2019WP.nc" "/scratch1/RDARCH/rda-ghpcs/Ryan.Lagerquist/ml4tccf_project/fake_extended_best_track_2020WP.nc" "/scratch1/RDARCH/rda-ghpcs/Ryan.Lagerquist/ml4tccf_project/fake_extended_best_track_2021WP.nc" "/scratch1/RDARCH/rda-ghpcs/Ryan.Lagerquist/ml4tccf_project/fake_extended_best_track_2017AL.nc" "/scratch1/RDARCH/rda-ghpcs/Ryan.Lagerquist/ml4tccf_project/fake_extended_best_track_2018AL.nc" "/scratch1/RDARCH/rda-ghpcs/Ryan.Lagerquist/ml4tccf_project/fake_extended_best_track_2019AL.nc" "/scratch1/RDARCH/rda-ghpcs/Ryan.Lagerquist/ml4tccf_project/fake_extended_best_track_2020AL.nc" "/scratch1/RDARCH/rda-ghpcs/Ryan.Lagerquist/ml4tccf_project/fake_extended_best_track_2021AL.nc" "/scratch1/RDARCH/rda-ghpcs/Ryan.Lagerquist/ml4tccf_project/fake_extended_best_track_2018EP.nc" "/scratch1/RDARCH/rda-ghpcs/Ryan.Lagerquist/ml4tccf_project/fake_extended_best_track_2019EP.nc" "/scratch1/RDARCH/rda-ghpcs/Ryan.Lagerquist/ml4tccf_project/fake_extended_best_track_2020EP.nc" "/scratch1/RDARCH/rda-ghpcs/Ryan.Lagerquist/ml4tccf_project/fake_extended_best_track_2021EP.nc" "/scratch1/RDARCH/rda-ghpcs/Ryan.Lagerquist/ml4tccf_project/fake_extended_best_track_2022EP.nc")

python3 -u "${CODE_DIR_NAME}/create_extended_best_track_file.py" \
--input_satellite_file_pattern="${SATELLITE_FILE_PATTERNS[$SLURM_ARRAY_TASK_ID]}" \
--output_fake_ebtrk_file_name="${FAKE_EBTRK_FILE_NAMES[$SLURM_ARRAY_TASK_ID]}"
